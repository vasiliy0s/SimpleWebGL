!function(a){"use strict";function b(a,c){return!this||this instanceof Window?new b(a,c):(this.width=a,this.height=c,this.fps=0,this.timeoutId=0,this.vars={},this.buffers={},this.textures={},this.gl=this.initGL(a,c),this.gl&&(this.setViewport(a,c),this.clear()),this)}b.prototype.name="SimpleWebGL",b.prototype.version="1.0",b.prototype.initGL=function(a,b){var c=null;if(window.Float32Array)try{this.cgl=document.createElement("canvas"),this.cgl.width=a,this.cgl.height=b;var c=this.cgl.getContext("webgl")||this.cgl.getContext("experimental-webgl")||this.cgl.getContext("webkit-3d")||this.cgl.getContext("moz-webgl")||null}catch(d){console.warn("SimpleWebGL cannot be initialized because current browser or operating system does not support WebGL rendering")}return c},b.prototype.appendTo=function(a){return this.cgl&&a instanceof HTMLElement&&a.appendChild(this.cgl),this},b.prototype.setViewport=function(a,b){return this.gl&&this.gl.viewport(0,0,a||this.cgl.width,b||this.cgl.height),this},b.prototype.setProgram=function(a){return this.gl&&"object"==typeof a&&(this.program=this.gl.createProgram(),this.createShader(a.vertex||"",this.gl.VERTEX_SHADER),this.createShader(a.fragment||"",this.gl.FRAGMENT_SHADER),this.gl.linkProgram(this.program),this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS)?(this.gl.useProgram(this.program),a.vars&&this.setShaderVars(a.vars)):console.warn("%s does not link main program",this.name)),this},b.prototype.setShaderVars=function(a){if("object"==typeof a&&this.gl&&this.program)for(var b in a)switch(b){case"attribute":if("object"==typeof a[b])for(var c in a[b])this.vars[a[b][c]]=this.gl.getAttribLocation(this.program,a[b][c]);else this.vars[a[b]]=this.gl.getAttribLocation(this.program,a[b]);break;case"uniform":if("object"==typeof a[b])for(var c in a[b])this.vars[a[b][c]]=this.gl.getUniformLocation(this.program,a[b][c]);else this.vars[a[b]]=this.gl.getUniformLocation(this.program,a[b])}return this},b.prototype.createShader=function(a,b){var c=null;return this.gl&&(c=this.gl.createShader(b),this.gl.shaderSource(c,a),this.gl.compileShader(c),this.gl.getShaderParameter(c,this.gl.COMPILE_STATUS)?this.program&&this.gl.attachShader(this.program,c):console.warn("%s does not compile %s from source: \n%s",this.name,b===this.gl.FRAGMENT_SHADER?"FRAGMENT_SHADER":b===this.gl.VERTEX_SHADER?"VERTEX_SHADER":"shader "+b,a)),c},b.prototype.setArrayBuffers=function(a){for(var b in a)this.buffers[b]=this.createBuffer(a[b],this.gl.ARRAY_BUFFER);return this},b.prototype.setElementsArrayBuffers=function(a){for(var b in a)this.buffers[b]=this.createBuffer(a[b],this.gl.ELEMENT_ARRAY_BUFFER);return this},b.prototype.createBuffer=function(a,b){var c=null;return this.gl&&(c=this.gl.createBuffer(),this.gl.bindBuffer(b,c),this.gl.bufferData(b,new Float32Array(a),this.gl.STATIC_DRAW),this.gl.bindBuffer(b,null)),c},b.prototype.setTextures=function(a){if("object"==typeof a)for(var b in a)this.textures[b]=this.createTexture(a[b]);return this},b.prototype.createTexture=function(a){var b=null;return this.gl&&(this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0),b=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,b),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,a),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.bindTexture(this.gl.TEXTURE_2D,null)),b},b.prototype.drawLoop=function(a){return"number"==typeof a&&a>0&&(this.drawStop(),this.fps=a),this.gl&&(function(a){a.timeoutId=setTimeout(function(){a.drawLoop.call(a)},1e3/a.fps)}(this),this.draw()),this},b.prototype.draw=function(){this.clear(),this.onDraw&&this.onDraw()},b.prototype.onDraw=function(a,b){return this.onDraw=function(a,b,c){return function(){b.apply(a,c)}}(this,a,b),this},b.prototype.drawStop=function(){return clearTimeout(this.timeoutId),this},b.prototype.clear=function(){return this.gl&&(this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT)),this};var c=a.SimpleWebGL;a.SimpleWebGL=b,b.prototype.noConflict=function(d){return a.SimpleWebGL=c,"string"==typeof d&&d?(a[d]=b,this):b}}(window);